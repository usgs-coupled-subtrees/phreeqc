


U.S. Geological Survey                                 phreeqc(1)



NAME
     phreeqc - A program for speciation, batch-reaction, one-
     dimensional transport, and inverse geochemical calculations

SYNOPSIS
     phreeqc [infile [outfile [database [screen_output]]]

OPTIONS
     infile          the name of the PHREEQC input file

     outfile         the name of the file to which PHREEQC output
                     will be written

     database        the name of the PHREEQC database

     screen_output   the name of the file to which screen output
                     will be directed

     If no arguments are specified, the program prompts for the
     input, output, and database file names.

     If only infile is specified, then outfile defaults to
     infile.out.  If no database file is specified, the
     phreeqc.dat database distributed with PHREEQC will be used.

ABSTRACT
     PHREEQC is a computer program written in the C programming
     language that is designed to perform a wide variety of low-
     temperature aqueous geochemical calculations.  PHREEQC is
     based on an ion-association aqueous model and has
     capabilities for (1) speciation and saturation-index
     calculations; (2) batch-reaction and one-dimensional (1D)
     transport calculations involving reversible reactions, which
     include aqueous, mineral, gas, solid-solution, surface-
     complexation, and ion-exchange equilibria, and irreversible
     reactions, which include specified mole transfers of
     reactants, kinetically controlled reactions, mixing of
     solutions, and temperature changes; and (3) inverse
     modeling, which finds sets of mineral and gas mole transfers
     that account for differences in composition between waters,
     within specified compositional uncertainty limits.

METHOD
     For speciation and batch-reaction calculations, PHREEQC
     solves sets of nonlinear mole-balance and mass-action
     equations that define an ion-association model.  A Newton-
     Raphson formulation is used to iteratively arrive at a
     solution to the equations.  A robust numerical method is
     provided by using an optimizing solver that allows both
     equality and inequality equations.  The solver is used to
     obtain the intermediate estimates of changes in the unknowns
     at each iteration.

     For inverse modeling, a set of linear mole-balance equations
     are solved.  The equations contain additional unknowns that
     account for uncertainty in the analytical data.  The
     optimizing solver is used to solve the linear equations
     while maintaining the uncertainty terms within specified
     limits.

     For transport modeling, the partial differential equations
     of transport are solved by an operator splitting scheme that
     sequentially solves for advective and dispersive transport,
     followed by chemical equilibration that is equivalent to
     batch-reaction calculations for each cell.  Time steps are
     selected to maintain numerical accuracy.  If kinetic
     reactions are modeled, yet another splitting of operators is
     implemented and a 5th order Runge-Kutta method is used to
     integrate the ordinary differential equations of the kinetic
     reactions.

HISTORY--See RELEASE.TXT for details
	
Version 2.10 Date: Tue November 2, 2004

	Rearranged i/o for PHREEQC and reorganized driver
	subroutine. The object of these changes is to make 
	the program more functional as a module for other 
	programs (PHAST) and eventually to produce a callable 
	C and Fortran module.

	Fixed a problem with surface related to a phase, when
	phase was not part of system (for example, Fe(OH)3a when
	there is no iron in system.

	Added convergence parameter set that requires mineral
	transfers to produce positive concentrations in the 
	event that negative concentrations have been produced in
	the prior Newton-Raphson iteration. (Fluorite example).

	Fixed bug with kinetics formulas; did not account for
	stoichiometric coefficient correctly when using
	phase names. Generalized to allow multiple phase
	names in the -formula definition.

Version 2.9 Date: Wed September 15, 2004

	In inverse modeling, program terminates if sum of initial
	solutions and phases is > 32.

	Fixed bug with isotopes. Log activity estimate after initial
	solution calculation was inf under some conditions. An initial
	surface calculation failed when using D.

	Changed saturation index print out to use reaction and log K
	defined in PHASES definition. Previously, reaction could be 
	rewritten to predominant redox species.

	Fixed incorrect print of elapsed time for kinetics in advection.

	Added phrqproto.h prototype file and phrqtype.h for
	switching compilation to long double.

	Fixed incorrect printout of kinetics delta moles with
	advection.

	Added convergence parameter set that skips mineral
	equations for first 5 iterations. 

	Added entity_exists for module.

	Tried to fix bug with mix index incorrect (-2) for
	mixing with kinetics.

	Added new keyword COPY that allows a data entity 
		to be copied from one index to a new index 
		or to a range of indicies. Format is 

		COPY keyword index index_start[-index_end]
	
		where keyword is one of the following:
			 	SOLUTION
				EQUILIBRIUM_PHASES
				EXCHANGE
				GAS_PHASE
				KINETICS
				MIX
				REACTION
				REACTION_TEMPERATURE
				SOLID_SOLUTION
				SURFACE

	Numerical method had a bug with ionic strength, if
		mass of water was not approximately 1. Routine
		revise_guesses did not divide by the mass of 
		water. Also changed check in routine molalities
		to check by molality, not moles.

	Fixed a null pointer when surface was related to a
		mineral and mineral was not in database.

	Added new Basic functions
	i = INSTR(a$, b$)  sets i to the character position of
		string b$ in a$, 0 in not found.
	b$ = LTRIM(a$)     trims white space from beginning of 
		string a$ and stores result in b$.
	b$ = RTRIM(a$)     trims white space from end of string 
		a$ and stores result in b$.
	b$ = LTRIM(a$)     trims white space from beginning and
		end of string a$ and stores result in b$.

	Added new Basic function SYS that calculates the to
	total amount of an element in all phases (solution,
	equilibrium_phases, surfaces, exchangers, solid solutions, 
	and gas phase). KINETIC reactions are not included.
	The function has two forms: (1) one element name as an
	argument (variable names are user specified)

	10 tot = SYS("As")

	the function will return the total arsenic in the system.
	(2) 5 argumens

	10 tot = SYS("As", count_species, names$, types$, moles)

	will return the total arsenic in the system to tot; count_species--
	the number of species that contain arsenic, including
	solution, equilibrium_phases, surfaces, exchangers, solid solutions, 
	and gas phase species; names$--a character array that has the
	name of each species; type$--a character array that specifies the
	type of phase for the species, aq, equi, surf, ex, s_s, gas, diff. 
	Diff refers to the amount of the element in the diffuse layer of 
	a surface when the explicit diffuse layer calculation is used; 
	moles--an array containing the number of moles of the element in 
	the species. The sum of moles(i) is equal to tot.

	SYS has several special arguments for the form 
	SYS("arg", count, names$, types$, values)
		arg 	is one of the options listed below.
		count 	is a single numeric value and is the number of elements
				in the following arrays.
		name$   is an array of string values.
		type$ 	is an array of string values.
		values 	is an array of numeric values.

	Values of arg:

	elt_name	returns total number of moles of element in system.
			count is the number of species for the element in
				the system, including aqueous, exchange, surface,
				equilibrium_phase, solid solution component, and
				gas phase "species".
			Arrays are filled for each "species"; values are moles.
	"elements" 	returns total number of moles of all elements, 
				valence states, exchangers, and surfaces.
			count is number of elements, valence states, 
				exchangers, and surfaces.
			Arrays are filled for each element, valence state,
				exchanger, and surface; values are moles.
	"phases"   	returns maximum saturation index of all phases.
			count is number of phases in system.
			Arrays are filled for each phase; values are
				saturation indexes.
	"aq"		returns sum of moles of all aqueous species.
			count is number of aqueous species in system.
			Arrays are filled with each aqueous species;
				values are moles.
	"ex"		returns sum of moles of all exchange species.
			count is number of exchange species in system.
			Arrays are filled with each exchange species;
				values are moles.
	"surf"		returns sum of moles of all surface species.
			count is number of surface species in system.
			Arrays are filled with each surface species;
				values are moles.
	"surf"		returns sum of moles of all solid solution components.
			count is number of solid solution components in system.
			Arrays are filled with each solid solution component;
				values are moles.
	"gas"		returns sum of moles of all gas components.
			count is number of gas components in system.
			Arrays are filled with each gas component;
				values are moles.

	Added new Basic function, DESCRIPTION, that has the value
	defined for the description field of the SOLUTION keyword line.	

	Added alternative ordinary differential equation solver
	called CVODE, a set of C routines from the Lawrence 
	Livermore National Labs. CVODE is part of the SUNDIALS
	package. CVODE is used in place of the Runge Kutta method
	when "-cvode true" is used within a KINETICS data block.

	KINETICS
		-cvode true

	Fixed error in SOLUTION_SPREAD, defining -redox
	did not set the default redox for the solutions
	that were defined; pe was always used as default.

	Modified code to allocate space differently for
	pp_assemblage, exchange, surface, gas_phase, 
	kinetics, and s_s_assemblage. Enough space is allocated
	at beginning of distribute_initial_conditions.
	May speed up phast initialization and make better
	use of available memory.

	Changed gfw of water to 18 if isotopes of water are 
	included. Solvent is [1H]2[16O].

	Fixed a bug in surface integration where order of ions
	in the list of g's was incorrect.

	Pyrite rate was not 0 if supersaturated in phreeqc.dat
	and wateq4f.dat

	Segmentation error if a surface species was not 
	defined with an equation that contained another surface
	species. In this case, the surface master species
	had been redefined to be an aqueous species (SOLUTION_SPECIES).

Version 2.8 Date: Tue April 15, 2003
	Updated arsenic data in wateq4f.dat to be consistent with
	Archer and Nordstrom (2002).

	Revised Basic interpreter to allow lines of any length and
	character strings of any length. 

	Renumbering basic statement that included the function SURF in
	PhreeqcI caused SURF to be omitted and generated a syntax
	error. SURF and other functions had not been implemented in
	PhreeqcI.

	Fixed a bug in the Basic Interpreter. If elements of
	a dimensioned variable (character or number) were used on 
	both sides of an equation, the result was erroneously 
	stored in the last element of the variable used on the 
	right-hand side instead of the element specified on the 
	left-hand side.

	Using comma in some fields caused an infinite loop.

	Fixed bug with SOLUTION_SPREAD, Phreeqc was not
	calculating solution numbers for solution_spread 
	solutions without solution numbers.

	Fixed bug with stagnant zone calculations. If solutions
	not defined for stagnant cells, PhreeqcI crashed.

	Added new state for calculations, PHAST. Previously
	phast used the state TRANSPORT, which caused some
	erroneous results with temperature when TRANSPORT was
	used in the PHREEQC part of the calculation.

	Trying to define dump file in TRANSPORT caused a file 
	opening error. Fixed logic so now can open a file
	and the name can include blanks.

    Version 2.7 Date: Fri February 14, 2003
	Changed format of selected output file: Removed quotations
	surrounding strings in headings; removed quotations
	surrounding strings in state variable. All fields are 12 or 20
	places depending on -high_precision. Headings are not
	truncated even if longer than specified precision.  For
	isotopes, missing value is -9999.9 Selected output is updated
	each simulation.  If a species or phase is defined subsequent
	to the simulation where SELECTED_OUTPUT was defined it will
	appear in the selected output file in the simulation in which
	it is defined and in subsequent simulations.

	Added strings for each file, which can be extracted from the
	executable file with the "ident" command.  Fixed null pointer
	for isotope_ratios if Basic routine was undefined.  Fixed
	problem in C++ if structure name is same as member name.  logk
	member of logk structure was renamed to log_k.

	Added identifier -add_constant to PHASES, EXCHANGE_SPECIES,
	SOLUTION_SPECIES, and SURFACE_SPECIES. 

	Added KEYWORDS: ISOTOPES, CALCULATE_VALUES, ISOTOPE_RATIOS,
	ISOTOPE_ALPHAS, NAMED_EXPRESSION
	
	Added Basic functions:
	calc_value("calc_value_name") 	evaluates a definition of CALCULATE_VALUES
	lk_named("name")		log10(K) of definition in NAMED_EXPRESSIONS
	lk_phase("name")		log10(K) of definition in PHASES
	lk_species("name")		log10(K) of definition in (SOLUTION, EXCHANGE, 
					SURFACE)_SPECIES
	sum_gas("template","element")   Sum of element in gases with specified template
					template="{C,[13C],[14C]}{O,[18O]}2" includes 
					all CO2 gases
	sum_species("template","element") Sum of element in aqueous, exchange, and 
					surface species with specified template
	sum_s_s("s_s_name","element")	Sum of element in a specified solid solution

	Added PRINT keyword options:
	-initial_isotopes  T/F
	-isotope_ratios    T/F
	-isotope_alphas    T/F
	-censor_species    1e-8   

	SELECTED_OUTPUT keyword:
	-calculate_values  name1 name2 ...
	-isotopes minor_isotope1 minor_isotope2 ....

	Added functions LK_SPECIES, LK_NAMED, LK_PHASE for Basic
	interpreter. LK_SPECIES("CaHCO3+") returns the log k for the
	association reaction for the ion pair CaHCO3+ at the current
	temperature. The log K is for the reaction as defined in the
	database or input file. Similarly,
	LK_NAMED("Log_alpha_18O_CO2(aq)/CO2(g)") returns the value for
	the log K at the current temperature using expressions defined
	in NAMED_LOG_K data block; LK_PHASE("Calcite") returns the
	value of log K for calcite at the current temperature for the
	dissociation reaction defined in the database or input
	file. Values are "log10" values.

	Added identifier -add_logk to SOLUTION_SPECIES
	EXCHANGE_SPECIES, SURFACE_SPECIES, and PHASES data
	block.

	SOLUTION keyword:
	At present, can only define isotopes in the units defined in ISOTOPES.


     Version 2.6 2002/04/22 - New batch release to correspond with
        initial release of PhreeqcI, an graphical user interface 
        to PHREEQC that runs under Windows operating systems. 
        Changes to PHREEQC include: (1) All selected_output is 
        routed through a single routine. (2) Underscores "_" are 
        allowed inside square brackets, [A_bcd] for element 
        definitions. (3) Fixed bug match_elts_in_species, check 
	for "e-" was wrong. (4) Modified minteq.dat to put 
        CuS4S5-3, Cu(S4)2-3 in Cu(1) mole balance equations 
        instead of Cu(2). Before the change, the program would 
        not converge if Cu(2) were defined in an initial solution.
        (5) Revisions to improve SOLID_SOLUTIONS convergence with 
        small numbers of moles of solids. (6) Made changes related 
        to dump file and PhreeqcI. (7) Printed number of iterations 
        now sums iterations in all kinetics calculations. (8) Fixed 
        bug with LA("H2O"), which was returning natural log of 
        activity of water.

     Version 2.5 2001/10/01 - (1) In llnl.dat, fixed sign errors
        in REE (rare earth elements) for some redox reactions and
        removed some redundant species, generally ReeO2- was
        retained and Ree(OH)4- was removed.  (2) Added the
        capability to use square brackets to define an "element"
        name.  The brackets act like quotation marks in that any
        character string can be used within the brackets as an
        element name.  This was introduced to simplify expansion
        of the model to isotopic species.  [13C], [14C], and
        [18O] are legal element names.  (3) Added identifier
        -activity_water for a species in SOLUTION_SPECIES data
        block.  This identifier has been added for future updates
        that will allow isotopic calculations.  It is intended to
        be used only for isotopic variations of H2O, like D2O or
        H2[O18].  It forces the activity coefficient for the
        species to be activity(water)/55.5.  This effectively
        sets the activity of the species to the mole fraction in
        solution.  (4) Fixed bug in checking solid solutions for
        presence or absence of elements in the system.
        Programming error caused segmentation fault if an error
        was detected under certain conditions.  (5) Changed
        return value of MOL to be molality of water if argument
        is "H2O".  Also changed return value of LA to be activity
        of water if argument is "H2O".  (6) Diffuse layer
        calculation was incorrect if aqueous phase did not have 1
        kilogram of water.  Eq. 74 of manual has molality, but
        code used moles.  The code was corrected by adding the
        mass of water to the formulation.  (7) Stagnant zones
        with first-order exchange approximation (1 stagnant cell,
        exchange factor, and porosities defined) did not work
        correctly if mobile and immobile cells did not have equal
        volumes of water.  The mixing factors were revised to
        account for the masses of water in the stagnant and
        mobile zones.  (8) A fatal error was erroneously detected
        if the database file had a DATABASE data block.  DATABASE
        data block is now ignored while reading the database
        file.  (9) Added identifier -bad_step_max to KINETICS
        data block.  An integer following -bad_step_max gives the
        maximum number of times a rate integration may fail
        before execution of the program is terminated.  Default
        is 500.

     Version 2.4.2 2001/06/15 - Fixed spreadsheet bug.  Program
        was not ignoring columns that could not be identified as
        either element names or allowed data (ph, pe, number,
        description, etc.).  Also, the program failed if a
        spreadsheet solution number was negative.

     Version 2.4.1 2001/06/04 - Fixed spreadsheet bugs with
        isotopes.

     Version 2.4 2001/06/01 - (1) Added structure for spreadsheet
        for use by PhreeqcI.  (2) Isotope value initialized
        incorrectly if only an -uncertainty was defined in
        SOLUTION_SPREAD.  (3) Fixed segmentation violation when
        primary and secondary master species were defined
        improperly.  (4) Corrected enthalpies of reaction in
        llnl.dat.  Previous release had erroneously had
        enthalpies of formation in -delta_H parameter; the values
        should be enthalpies of reaction.  Enthalpies of reaction
        were calculated from the enthalpies of formation and
        these values are now included in the -delta_H parameter.
        This change will have very little impact on calculations
        because the analytical expression has precedence over
        -delta_H in calculating temperature dependence of log K,
        and nearly all species and minerals have an analytical
        expression or lack both an analytical expression and an
        enthalpy of reaction.  (5) Corrected bugs in punch of
        solid solution components that caused both selected
        output and output file errors:  moles were incorrect in
        selected output, and total moles and mole fraction were
        incorrect in output file.  (6) Added surface complexation
        constants for Fe+2; two complexes for weak sites and one
        complex for strong sites.  phreeqc.dat and wateq4f.dat
        modified.  (7) Comment for units of parameters for
        calcite rate equation was wrong.  Rate equation now uses
        cm^2/L for area parameter.  Previously the correct units
        would have been 1/decimeter.  phreeqc.dat and wateq4f.dat
        modified.  (8) Fixed a bug when rates were equal within
        tolerance, but negative concentrations occurred because
        of small initial concentrations.  (9) Added -warnings to
        PRINT keyword for specification of maximum number of
        warnings to print.  Negative number allows all warnings
        to be printed.  (10) Function CELL_NO in Basic now prints
        a number equivalent to -solution in SELECTED_OUTPUT data
        block.  This does not change printing for ADVECTION or
        TRANSPORT calculations.  (11) Kinetics time is halved for
        advective part of reaction in transport; time incorrectly
        accounted for before.  (12) -punch_ identifiers printed
        -1 instead of the correct solution number for batch-
        reaction calculations.  (13) -high_precision is no longer
        reset to false with every SELECTED_OUTPUT data block.
        (14) SELECTED_OUTPUT file name stored for use by
        PhreeqcI.  (15) Alkalinity for NH3 corrected to 1.0 in
        llnl.dat.  (16) Fixed bug with USER_PRINT of kinetics.
        Did not find correct kinetics information in some cases.
        (17) Fixed bug in default values for SOLUTION_SPREAD.
        Cannot use phase name and SI for pH or pe, and bug did
        not allow PHREEQC to run.  Now PHREEQC runs, but warns
        that this is not allowed.

     Version 2.3 2001/01/02 - (1) Added new keyword DATABASE.  It
        must be the first keyword in the input file.  The
        character string following the keyword is the pathname
        for the database file to be used in the calculation.  The
        file that is specified takes precedence over any default
        database name, including environmental variable
        PHREEQC_DATABASE and command line arguments.  (2) Fixed
        bug in SOLUTION_SPREAD.  If first heading in the
        spreadsheet input was an identifier--pH, pe, units,
        etc.--then the headings were interpreted as an identifier
        and bad things happened.  (3) Added new keyword to make
        aqueous model similar to LLNL and Geochemists Workbench
        when using llnl.dat as the database file.  Values of
        Debye-Huckel a and b and bdot (ionic strength
        coefficient) are read at fixed temperatures.  Linear
        interpolation occurs between temperatures.  (4) New
        options for SOLUTION_SPECIES are -llnl_gamma a, where a
        is the ion-size parameter.  -co2_llnl_gamma, indicates
        the temperature dependent function for the bdot term
        given in -co2_coefs of LLNL_AQUEOUS_MODEL_PARAMETERS will
        be used.  Applies to uncharged species only.  (5) Fixed
        bug in basic interpreter.  A number like "..524" would
        cause an infinite loop.  (6) Added function SURF to
        Basic.  SURF("element", "surface") gives the amount of
        element in the diffuse layer for "surface".  "surface"
        should be the surface name, not the surface-site name
        (that is, no underscore).  (7) Fixed option to
        "runge_kutta" from "runge-kutta" to match documentation
        for KINETICS.  (8) Fixed UO2+2 and Mn+2 reaction
        stoichiometry for Hfo surface complexation in
        wateq4f.dat.  (9) Added option for an equilibrium-phase
        to dissolve only.  "dis" is added at the end of a line
        defining an equilibrium-phase.  No data fields may be
        omitted.  Should not be used when adding an alternative
        reaction.  (10) R-K integration failed when only the
        final rate generated negative concentrations.  (11) Allow
        decimals in definition of secondary master species, for
        example S(0.3).  (12) Fixed bug if description was more
        than about 85 characters; now allows about 400
        characters.  (13) Fixed bug for surface/exchange sites
        related to phases.  Was checking internal copies of
        surfaces/exchange with negative numbers.  (14) Fixed bug
        in quick prep that did not set the correct pointer for
        gas phases.  (15) Fixed segmentation fault that occurred
        if all elements for phase-boundary mineral were not in
        the solution.  Only applied to a phase used to define
        concentration in an initial solution calculation.  (16)
        Added option to eliminate echo of input file in PRINT
        data block.  -echo_input T/F turns echoing on and off.
        Default is on.

     Version 2.2 2000/03/01 - (1) Fixed bug in MIX if no
        solutions are defined.  (2) Changed printout for surface;
        only gives net surface charge when -diffuse_layer is
        defined; prints correct value for the surface charge and
        surface charge density for diffuse-layer calculation.
        (3) Added new function EDL to Basic, which gives
        information about surfaces.  EDL("element", "surface")
        gives the amount of element in the diffuse layer for
        "surface" if -diffuse_layer is used, zero otherwise.  The
        "surface" should be the surface name, not the surface-
        site name (that is, no underscore).  Special values for
        "element" include: "charge"--gives surface charge,
        equivalents (all options), "sigma"--surface charge
        density, C/m**2 (default or -diffuse_layer options),
        "psi"--potential at the surface, Volts (default or
        -diffuse_layer options), "water"--mass of water in the
        diffuse layer, kg (-diffuse_layer option).  Value of
        function is zero for any undefined quantities.  (4)
        Changed distribution to be more consistent with other
        USGS water-resources applications.

     Version 2.1 2000/01/19 - Fixed problem in DOS version
        preventing last digit of 3-digit exponent from printing
        for PUNCH and PRINT commands included in USER_PUNCH and
        USER_PRINT input data blocks, respectively.

     Version 2.0 1999/12/15 - Enhancements added to extend
        capabilities to simulate dispersion (or diffusion) and
        stagnant zones in 1D-transport calculations, to model
        kinetic reactions with user-defined rate expressions, to
        model the formation or dissolution of ideal,
        multicomponent or nonideal, binary solid solutions, to
        model fixed-volume gas phases in addition to fixed-
        pressure gas phases, to allow the number of surface or
        exchange sites to vary with the dissolution or
        precipitation of minerals or kinetic reactants, to
        include isotope mole balances in inverse modeling
        calculations, to automatically use multiple sets of
        convergence parameters, to print user-defined quantities
        to the primary output file and (or) to a file suitable
        for importation into a spreadsheet, and to define
        solution compositions in a format more compatible with
        spreadsheet programs.

     Version 1.6 1998/01/16 - Code fixes: (A) Scaled 1/u factors
        by 1e-3 in inverse modeling, may help with precision
        problems in solver.  (B) Fixed bug in inverse modeling.
        If carbon alkalinity was small relative to total
        alkalinity, speciation in carbon-derivative calculation
        failed.  (C) Changed parameterization of Debye-Huckel A
        and B to be consistent with Wateq4f.  (D) Fixed pointer
        fault if specified solution does not exist for initial
        surface or initial exchange calculation.  (E) Changed
        databases: (1) Units for Delta_H for H2 and Goethite
        incorrectly defaulted to kJ/mol.  Now explicitly
        kcal/mol.  (2) Added analytical expression for H2S, NH3,
        KSO4.  (3) Added species CaHSO4+.  (4) Added delta H for
        Goethite.  (5) changed logK for jarosite(ss).  (F) Check
        for misuse of "as CaCO3" for alkalinity.  (G) Revise
        guesses does not fail after 30 iterations.  Now goes
        through another 30 iterations to make calculated moles
        less than total, but not necessarily within 5 orders of
        magnitude of the total.  (H) Added logic to use " " file
        names.  (I) Added logic to allow "Alkalinity" to be
        printed to the selected output file through -totals
        option of keyword SELECTED_OUTPUT.  (J) Fixed bug in
        SELECTED_OUTPUT where log activities were not printed
        correctly for non-master species.  (K) Fixed bug where
        space for exchange and surface was always freed, but not
        always allocated.  (L) Fixed bug in selected_output file
        where solution number was not printed correctly for
        reaction and transport calculations.  (M) Now stops
        execution if error occurs in get_elements_in_species.
        (N) In EQUILIBRIUM_PHASES, only accepted alternate-
        formula phase name if it began with a capital letter.

     Version 1.5 1997/01/31 - Code fixes: (A) after a reaction
        calculation, saving a range of  exchangers, surfaces, gas
        phases, or equilibrium_phases now functions correctly;
        (B) in reaction calculations, diffuse_layer calculations
        is now reset properly as the value for surface, if
        surface is used, or to FALSE if not used; (C) in
        transport simulations, for cell n, mixing was only
        correct using cells j < n.  Cells j > n, had already been
        updated with mixing and reactions.  Now cell n+1, remains
        as it was before mixing and reactions until after mixing
        and reactions are calculated for cell n; (D) now
        correctly handles situations where both mineral amounts
        and aqueous concentrations for an element were very
        small, in the range of 1e-14.  Some parameters were
        adjusted to try to improve the selection of minerals to
        include in the Jacobian.  As has been the case, but maybe
        not stated, it is possible to lose mass at these
        concentrations, because amounts of minerals less than
        1e-14 are set to 0.0; (E) when an element was missing
        from the system (not in solution, but mineral with zero
        mass was specified), a warning message that used a NULL
        pointer has been fixed.

     Version 1.4 1996/10/18 - Fixed an error that occurred during
        transport or reaction calculations.  If a concentration
        of an element was less than 1e-14 (Mn in equilibrium with
        pyrolusite in the specific example), then under some
        conditions a warning message would be printed ("WARNING:
        Element in phase, Pyrolusite, is not in model.")  and
        erroneous results could be calculated.  Error message was
        changed to include the offending element.  Fixed an error
        in inverse modeling that occurred when dissolved oxygen
        or O2(g) were part of an inverse model.  The
        stoichiometry of electron and alkalinity change per mole
        of oxygen were wrong.  This could have caused erroneous
        mole-balance models when using versions 1.3 and lower.
        Similar errors would occur with any element or valence
        state that has a master species with stoichiometry 2 or
        greater for the element or valence state (N2 for
        example).  Added analytical expressions to phreeqc.dat
        and wateq4f.dat aqueous species NH3, KSO4-, HS-.  Added
        delta_H for goethite.  Added species CaHSO4+ to
        phreeqc.dat.  All data from WATEQ4F manual.

     Version 1.3 1996/07/30 - Included minteq.dat, a translated
        MINTEQA2 database for all but DOM (dissolved organic
        matter) species and some species that could not be
        deciphered.  Added check to make sure minimum number of
        species are defined, e-, H+, H2O, H2, O2, and minimum
        number of master species are defined, H(0), H(1), O(-2),
        O(0), E.  Removed limitation on number of strings.  Also
        upped initial dimension from 1500 strings to 3000.  Fixed
        various errors in the program including the following.
        Fixed logic resulting in segmentation fault when parsing
        equations.  Fixed incomplete error message for invalid
        output file name.  Fixed divide by zero problem when
        activity of a master species in an intermediate iteration
        was very small.  In inverse modeling, fixed bug with
        -balances that did not interpret valence states with a
        "+" sign correctly.  N(+5) caused a segmentation fault,
        although N(5) executed correctly.

     Version 1.2 1996/03/22 - Fixed bug if number of aqueous
        species for a solution > 250 added code to dynamically
        allocate sufficient space.  Fixed most warnings from
        Borland C++ compiler.  Fixed bug with opening files, if
        nonexistent file is given.  Closes all files before
        exiting.  Acrobat version of documentation included in
        distribution.

     Version 1.1 1995/11/22 - Fixed bug with "use" data.
        Selection process for reactions was not working
        correctly.  Wrong solution could be used in reaction
        calculation.  Used purify to remove memory errors.

     Version 1.0 1995/10/12 - First release.

DATA REQUIREMENTS
     Proper use of the program requires adequate knowledge of
     geochemistry and a proper formulation of the problem.  Input
     is arranged in keyword data blocks, which can appear in any
     order.  Data fields for a keyword are read in a free format,
     thus they are not column dependent.

     For speciation modeling, analytical data for a solution
     composition (SOLUTION keyword) are needed.

     For batch-reaction modeling, the initial solution
     composition is required (SOLUTION or MIX data block).  Other
     equilibrium reactants may be defined with
     EQUILIBRIUM_PHASES, EXCHANGE, SURFACE, GAS_PHASE, and
     SOLID_SOLUTION data blocks.  Nonequilibrium reactions may be
     defined with KINETICS and RATES, REACTION, and
     REACTION_TEMPERATURE data blocks.

     For 1D transport modeling, the data for batch-reaction
     modeling are needed for each cell in the modeled system.  In
     addition, physical information is needed about column
     dimensions, time steps, boundary conditions, and
     dispersivity.

     For inverse modeling, the solution composition of the final
     solution and one or more initial solutions are needed
     (SOLUTION data block).  Uncertainty limits must be defined
     explicitly or by default for each element and element redox
     state in the solutions.  In addition, the identity and
     composition of a set of plausible reactants and products are
     needed.

     Three default databases are included that contain the
     definition of aqueous species, exchange species, surface
     species, and mineral and phases for a set of elements.  The
     database phreeqc.dat contains information for Al, B, Ba, Br,
     C, Ca, Cd, Cl, Cu, F, Fe, H, K, Li, Mg, Mn, N, Na, O, P, S,
     Si, Sr, Zn.  The database wateq4f.dat contains the
     additional constituents Ag, As, Cs, Fulvate, Humate, I, Ni,
     Rb, Se, and U.  The database minteq.dat is derived from the
     thermodynamic data of the program MINTEQA2.  If additional
     elements, species, or phases are needed, then chemical
     reactions, log K, and data for the temperature dependence of
     log K are needed for each additional species and phase.

SYSTEM REQUIREMENTS
     PHREEQC is written in ANSI C.  Generally, the program is
     easily installed on most computer systems.  The code has
     been used on UNIX-based computers and on IBM-compatible
     computers with processors running at 100 megahertz or
     faster.

DOCUMENTATION
     Parkhurst, D.L., and Appelo, C.A.J., 1999, User's guide to
        PHREEQC (Version 2)--a computer program for speciation,
        batch-reaction, one-dimensional transport, and inverse
        geochemical calculations: U.S. Geological Survey Water-
        Resources Investigations Report 99-4259, 312 p.

     Thorstenson, D.C., and Parkhurst, D.L., 2002, Calculation of
        individual isotope equilibrium constants for implementation in
        geochemical models: U.S. Geological Survey Water-Resources
        Investigations Report 02-4172, 129 p.

RELATED DOCUMENTATION

     Charlton, S.R., Macklin, C.L. and Parkhurst, D.L., 1997,
        PHREEQCI--a graphical user interface for the geochemical
        computer program PHREEQC: U.S. Geological Survey Water-
        Resources Investigations Report 97-4222, 9 p.

    Charlton, S.R., and Parkhurst, D.L., 2002, PhreeqcI--A graphical user
        interface to the geochemical model PHREEQC: U.S. Geological Survey 
        Fact Sheet FS-031-02, 2 p.

     Parkhurst, D.L., Thorstenson, D.C., and Plummer, L.N., 1980,
        PHREEQE--a computer program for geochemical calculations:
        U.S. Geological Survey Water-Resources Investigations
        Report 80-96, 195 p. (Revised and reprinted, 1990.)

     Plummer, L.N., Parkhurst, D.L., Fleming, G.W., and Dunkle,
        S.A., 1988, A computer program incorporating Pitzer's
        equations for calculation of geochemical reactions in
        brines: U.S. Geological Survey Water-Resources
        Investigations Report 88-4153, 310 p.

     Plummer, L.N., Prestemon, E.C., and Parkhurst, D.L., 1991,
        An interactive code (NETPATH) for modeling NET
        geochemical reactions along a flow PATH:  U.S.
        Geological Survey Water-Resources Investigations Report
        91-4078, 227 p.

     Plummer, L.N., Prestemon, E.C., and Parkhurst, D.L., 1994,
        An interactive code (NETPATH) for modeling NET
        geochemical reactions along a flow PATH--version 2.0:
        U.S. Geological Survey Water-Resources Investigations
        Report 94-4169, 130 p.

REFERENCES
     Appelo, C.A.J., and Postma, D., 1993, Geochemistry,
        groundwater and pollution:  Rotterdam, Netherlands, and
        Brookfield, Vermont, A.A. Balkema.

     Appelo, C.A.J., and Willemsen, A., 1987, Geochemical
        calculations and observations on salt water intrusions.
        I: A combined geochemical/mixing cell model: Journal of
        Hydrology, v. 94, p. 313-330.

     Parkhurst, D.L., and Plummer, L.N., 1993, Geochemical
        models, in Alley, W.M., ed., Regional ground-water
        quality: New York, Van Nostrand Reinhold, chap. 9, p.
        199-225.

     Plummer, L.N., 1984, Geochemical modeling: A comparison of
        forward and inverse methods, in Hitchon, B., and Wallick,
        E.I., eds., Proceedings First Canadian/American
        Conference on Hydrogeology--Practical Applications of
        Ground Water Geochemistry, Banff, Alberta, Canada:
        Worthington, Ohio, National Water Well Association, p.
        149-177.

TRAINING
     PHREEQC is taught as part of the courses Geochemistry for
     Ground-Water Systems (GW3021TC) at the USGS National
     Training Center.

CONTACTS
     Operation:
        U.S. Geological Survey
        David Parkhurst
        Denver Federal Center, MS 413
        Lakewood, CO  80225

        dlpark@usgs.gov


     Official versions of U.S. Geological Survey water-resources
     analysis software are available for electronic retrieval via
     the World Wide Web (WWW) at:

                http://water.usgs.gov/software/

     and via anonymous File Transfer Protocol (FTP) from:

                water.usgs.gov (path: /pub/software).

     See
     http://water.usgs.gov/software/ordering_documentation.html
     for information on ordering printed copies of USGS
     publications.

SEE ALSO
     netpath(1) - Interactive program for calculating NET
                  geochemical reactions and radiocarbon dating
                  along a flow PATH

     phreeqci(1) - Graphical user interface for PHREEQC

     phrqpitz(1) - A program for geochemical calculations in
                   brines

     wateq4f(1) - A program for calculating speciation of major,
                  trace, and redox elements in natural waters

